<!doctype html><html lang=en-us><head><title>Kafka Connect Quickstart // goatwu1993</title><link rel="shortcut icon" href=/favicon.ico><meta charset=utf-8><meta name=generator content="Hugo 0.79.1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="goatwu1993"><meta name=description content><link rel=stylesheet href=https://goatwu1993.github.io/blog/css/main.min.68e582a4d4ed824d6b7e3b5b37cae47eb3779bd631046379d0e68b38230cc3e2.css><meta name=twitter:card content="summary"><meta name=twitter:title content="Kafka Connect Quickstart"><meta name=twitter:description content="Kafka+ELK"><meta property="og:title" content="Kafka Connect Quickstart"><meta property="og:description" content="Kafka+ELK"><meta property="og:type" content="article"><meta property="og:url" content="https://goatwu1993.github.io/blog/posts/note-kafka/kafka-elk/"><meta property="article:published_time" content="2020-01-30T00:00:00+00:00"><meta property="article:modified_time" content="2020-02-12T00:00:00+00:00"></head><body><header class=app-header><a href=https://goatwu1993.github.io/blog/><img class=app-header-avatar src=/blog/avatar.jpg alt=goatwu1993></a><h1>goatwu1993</h1><nav class=app-header-menu><a class=app-header-menu-item href=/blog/>Home</a>
-
<a class=app-header-menu-item href=/blog/tags/>Tags</a>
-
<a class=app-header-menu-item href=/blog/about/>About</a></nav><p>Taiwan. Backend/DevOps. Python.</p><div class=app-header-social><a href=https://github.com/goatwu1993 target=_blank rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github"><title>Github</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></div></header><main class=app-container><article class=post><header class=post-header><h1 class=post-title>Kafka Connect Quickstart</h1><div class=post-meta><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Jan 30, 2020</div><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>6 min read</div><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag"><title>tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg><a class=tag href=https://goatwu1993.github.io/blog/tags/hadoop/>hadoop</a>
<a class=tag href=https://goatwu1993.github.io/blog/tags/kafka/>kafka</a>
<a class=tag href=https://goatwu1993.github.io/blog/tags/bigdata/>bigdata</a></div></div></header><div class=post-content><p>Slighty modified from Confluent&rsquo;s example. Only version is updated.</p><ul><li>confluent platform docker version 5.4.0</li><li>mysql version 8.0.19</li></ul><p>Note that docker-compose.yml is slightly modified from <a href=https://github.com/confluentinc/cp-docker-images/blob/5.3.0-post/examples/cp-all-in-one/docker-compose.yml>cp-all-in-one</a> in order to be easily understood.</p><p>The docker images is <strong>NOT Size-Mininized</strong>.</p><h2 id=prerequisites>Prerequisites</h2><ul><li>Docker</li><li>Docker Compose</li><li>curl</li><li><strong>Docker-Machine</strong><br>Docker for mac is not as native as Linux. Weird network behavior may occur.<br>Better use docker-machine to avoid it.</li></ul><h2 id=mac-start-docker-machine>(Mac) Start Docker-Machine</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># if using docker-machine</span>
<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> docker-machine &gt;/dev/null 2&gt;&amp;<span style=color:#ae81ff>1</span> <span style=color:#f92672>]</span>
<span style=color:#66d9ef>then</span>
    docker-machine create --driver virtualbox --virtualbox-memory <span style=color:#ae81ff>6000</span> confluent
<span style=color:#66d9ef>else</span>
    echo <span style=color:#e6db74>&#34;Docker is native on your system&#34;</span>
<span style=color:#66d9ef>fi</span>
echo <span style=color:#e6db74>&#34;continue&#34;</span>
</code></pre></div><pre><code>Docker machine &quot;confluent&quot; already exists
continue
</code></pre><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker-machine start confluent
echo <span style=color:#e6db74>&#34;continue&#34;</span>
</code></pre></div><pre><code>Starting &quot;confluent&quot;...
Machine &quot;confluent&quot; is already running.
continue
</code></pre><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> docker-machine &gt;/dev/null 2&gt;&amp;<span style=color:#ae81ff>1</span> <span style=color:#f92672>]</span>
<span style=color:#66d9ef>then</span>
    eval <span style=color:#66d9ef>$(</span>docker-machine env confluent<span style=color:#66d9ef>)</span>
<span style=color:#66d9ef>else</span>
    echo <span style=color:#e6db74>&#34;Docker is native on your system&#34;</span>
<span style=color:#66d9ef>fi</span>
</code></pre></div><h2 id=download-mysql-jdbc-driver>Download MySQL JDBC Driver</h2><p>It is important to make sure the <strong>version of MySQL-JDBC</strong> match <strong>the version of MySQL</strong>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker-compose stop
echo
docker-compose rm -f
</code></pre></div><pre><code>Stopping control-center  ...
Stopping connect         ...
Stopping schema-registry ...
Stopping broker          ...
Stopping zookeeper       ...
[1Bping zookeeper       ... [32mdone[0m
Going to remove control-center, quickstart-mysql, connect, schema-registry, broker, zookeeper
Removing control-center   ...
Removing quickstart-mysql ...
Removing connect          ...
Removing schema-registry  ...
Removing broker           ...
Removing zookeeper        ...
[6Bving control-center   ... [32mdone[0m
</code></pre><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker run --rm mysql --version
</code></pre></div><pre><code>/usr/sbin/mysqld  Ver 8.0.19 for Linux on x86_64 (MySQL Community Server - GPL)
</code></pre><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> docker-machine &gt;/dev/null 2&gt;&amp;<span style=color:#ae81ff>1</span> <span style=color:#f92672>]</span>
<span style=color:#66d9ef>then</span>
    docker-machine ssh confluent -- <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span><span style=color:#e6db74>    sudo mkdir -p /tmp/quickstart/jars;
</span><span style=color:#e6db74>    sudo curl -k \
</span><span style=color:#e6db74>        -s \
</span><span style=color:#e6db74>        -SL \
</span><span style=color:#e6db74>        \&#34;http://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-8.0.19.tar.gz\&#34; |
</span><span style=color:#e6db74>        sudo tar -xzf - -C \
</span><span style=color:#e6db74>            /tmp/quickstart/jars \
</span><span style=color:#e6db74>            --strip-components=1 \
</span><span style=color:#e6db74>            mysql-connector-java-8.0.19/mysql-connector-java-8.0.19.jar;
</span><span style=color:#e6db74>    ls -la /tmp/quickstart/jars
</span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
<span style=color:#66d9ef>else</span>
    sudo mkdir -p /tmp/quickstart/jars;
    sudo curl -k <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>        -s <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>        -SL <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>        <span style=color:#ae81ff>\&#34;</span>http://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-8.0.19.tar.gz<span style=color:#ae81ff>\&#34;</span> |
        sudo tar -xzf - -C <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>            /tmp/quickstart/jars <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>            --strip-components<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>            mysql-connector-java-8.0.19/mysql-connector-java-8.0.19.jar;
    ls -la /tmp/quickstart/jars
<span style=color:#66d9ef>fi</span>
</code></pre></div><pre><code>total 2312
drwxr-xr-x    2 root     root          4096 Mar  2 22:27 .
drwxr-xr-x    4 root     root          4096 Mar  2 22:19 ..
-rw-r--r--    1 root     root       2356711 Dec  4 11:44 mysql-connector-java-8.0.19.jar
</code></pre><h3 id=mysql-jdbc>MySQL-JDBC</h3><ul><li><a href=https://dev.mysql.com/downloads/connector/j/>MySQL Engineering Blogs</a></li><li><a href=https://mvnrepository.com/artifact/mysql/mysql-connector-java/8.0.19>mvnrepository</a></li></ul><h2 id=start-docker-compose>Start Docker Compose</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker-compose up -d
</code></pre></div><pre><code>Creating zookeeper ...
[1BCreating broker    ... mdone[0m
[1BCreating schema-registry ... [0m
[1BCreating connect         ... mdone[0m
[1BCreating control-center  ... mdone[0m
Creating quickstart-mysql ...
[1Bting quickstart-mysql ... [32mdone[0m
</code></pre><h2 id=insert-data-into-mysql>Insert data into MySQL</h2><p>MySQL container may take a while until it can function.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Nasty script to wait for mysql be ready</span>
<span style=color:#66d9ef>while</span> ! docker exec quickstart-mysql mysql --user<span style=color:#f92672>=</span>confluent --password<span style=color:#f92672>=</span>confluent -e <span style=color:#e6db74>&#34;SELECT 1&#34;</span> &gt;/dev/null 2&gt;&amp;1; <span style=color:#66d9ef>do</span>
    sleep <span style=color:#ae81ff>1</span>
<span style=color:#66d9ef>done</span>
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker exec -i quickstart-mysql mysql -u confluent -pconfluent <span style=color:#f92672>&lt;&lt;&lt;</span> <span style=color:#e6db74>&#34;&#34;&#34;
</span><span style=color:#e6db74>CREATE DATABASE IF NOT EXISTS connect_test;
</span><span style=color:#e6db74>USE connect_test;
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>DROP TABLE IF EXISTS test;
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>CREATE TABLE IF NOT EXISTS test (
</span><span style=color:#e6db74>  id serial NOT NULL PRIMARY KEY,
</span><span style=color:#e6db74>  name varchar(100),
</span><span style=color:#e6db74>  email varchar(200),
</span><span style=color:#e6db74>  department varchar(200),
</span><span style=color:#e6db74>  modified timestamp default CURRENT_TIMESTAMP NOT NULL,
</span><span style=color:#e6db74>  INDEX \`modified_index\` (\`modified\`)
</span><span style=color:#e6db74>);
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>INSERT INTO test (name, email, department) VALUES (&#39;alice&#39;, &#39;alice@abc.com&#39;, &#39;engineering&#39;);
</span><span style=color:#e6db74>INSERT INTO test (name, email, department) VALUES (&#39;bob&#39;, &#39;bob@abc.com&#39;, &#39;sales&#39;);
</span><span style=color:#e6db74>INSERT INTO test (name, email, department) VALUES (&#39;bob&#39;, &#39;bob@abc.com&#39;, &#39;sales&#39;);
</span><span style=color:#e6db74>INSERT INTO test (name, email, department) VALUES (&#39;bob&#39;, &#39;bob@abc.com&#39;, &#39;sales&#39;);
</span><span style=color:#e6db74>INSERT INTO test (name, email, department) VALUES (&#39;bob&#39;, &#39;bob@abc.com&#39;, &#39;sales&#39;);
</span><span style=color:#e6db74>INSERT INTO test (name, email, department) VALUES (&#39;bob&#39;, &#39;bob@abc.com&#39;, &#39;sales&#39;);
</span><span style=color:#e6db74>INSERT INTO test (name, email, department) VALUES (&#39;bob&#39;, &#39;bob@abc.com&#39;, &#39;sales&#39;);
</span><span style=color:#e6db74>INSERT INTO test (name, email, department) VALUES (&#39;bob&#39;, &#39;bob@abc.com&#39;, &#39;sales&#39;);
</span><span style=color:#e6db74>INSERT INTO test (name, email, department) VALUES (&#39;bob&#39;, &#39;bob@abc.com&#39;, &#39;sales&#39;);
</span><span style=color:#e6db74>INSERT INTO test (name, email, department) VALUES (&#39;bob&#39;, &#39;bob@abc.com&#39;, &#39;sales&#39;);
</span><span style=color:#e6db74>SELECT * FROM test;
</span><span style=color:#e6db74>&#34;&#34;&#34;</span>
</code></pre></div><pre><code>mysql: [Warning] Using a password on the command line interface can be insecure.
id	name	email	department	modified
1	alice	alice@abc.com	engineering	2020-03-02 22:29:15
2	bob	bob@abc.com	sales	2020-03-02 22:29:15
3	bob	bob@abc.com	sales	2020-03-02 22:29:15
4	bob	bob@abc.com	sales	2020-03-02 22:29:15
5	bob	bob@abc.com	sales	2020-03-02 22:29:15
6	bob	bob@abc.com	sales	2020-03-02 22:29:15
7	bob	bob@abc.com	sales	2020-03-02 22:29:15
8	bob	bob@abc.com	sales	2020-03-02 22:29:15
9	bob	bob@abc.com	sales	2020-03-02 22:29:15
10	bob	bob@abc.com	sales	2020-03-02 22:29:15
</code></pre><h2 id=source-connector>Source Connector</h2><h3 id=add-source-connector>Add source connector</h3><p>Either API or Web UI(Confluent Platform) will acheive the goal.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>export CONNECT_NET<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;kafka-connect-mysql_default&#34;</span>
</code></pre></div><p>We have to wait for Kafka Connect to totally start up.</p><p>To speed up the process, remove some directory from <strong>CONNECT_PLUGIN_PATH</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>      <span style=color:#75715e>#CONNECT_PLUGIN_PATH: &#34;/usr/share/java,/usr/share/confluent-hub-components&#34;</span>
      CONNECT_PLUGIN_PATH: <span style=color:#e6db74>&#34;\
</span><span style=color:#e6db74>        /usr/share/java/kafka,\
</span><span style=color:#e6db74>        /usr/share/confluent-hub-components,\
</span><span style=color:#e6db74>        /usr/share/java/kafka-connect-jdbc,\
</span><span style=color:#e6db74>        /etc/kafka-connect/jars&#34;</span>
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#66d9ef>while</span> ! docker logs connect 2&gt;&amp;<span style=color:#ae81ff>1</span> | grep -i <span style=color:#e6db74>&#34;INFO Kafka Connect started&#34;</span> ; <span style=color:#66d9ef>do</span>
     sleep <span style=color:#ae81ff>1</span>
<span style=color:#66d9ef>done</span>
</code></pre></div><pre><code>[2020-03-02 22:32:15,768] INFO Kafka Connect started (org.apache.kafka.connect.runtime.Connect)
</code></pre><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Call the API of connect</span>
docker run <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --net<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>CONNECT_NET<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --rm curlimages/curl:7.68.0 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    -X POST <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    -s <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --data <span style=color:#e6db74>&#39;{ &#34;name&#34;: &#34;quickstart-jdbc-source&#34;, &#34;config&#34;: { &#34;connector.class&#34;: &#34;io.confluent.connect.jdbc.JdbcSourceConnector&#34;, &#34;tasks.max&#34;: 1, &#34;connection.url&#34;: &#34;jdbc:mysql://quickstart-mysql:3306/connect_test?user=root&amp;password=confluent&#34;, &#34;mode&#34;: &#34;incrementing&#34;, &#34;incrementing.column.name&#34;: &#34;id&#34;, &#34;timestamp.column.name&#34;: &#34;modified&#34;, &#34;topic.prefix&#34;: &#34;quickstart-jdbc-&#34;, &#34;poll.interval.ms&#34;: 1000 } }&#39;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    http://connect:8083/connectors
</code></pre></div><pre><code>{&quot;name&quot;:&quot;quickstart-jdbc-source&quot;,&quot;config&quot;:{&quot;connector.class&quot;:&quot;io.confluent.connect.jdbc.JdbcSourceConnector&quot;,&quot;tasks.max&quot;:&quot;1&quot;,&quot;connection.url&quot;:&quot;jdbc:mysql://quickstart-mysql:3306/connect_test?user=root&amp;password=confluent&quot;,&quot;mode&quot;:&quot;incrementing&quot;,&quot;incrementing.column.name&quot;:&quot;id&quot;,&quot;timestamp.column.name&quot;:&quot;modified&quot;,&quot;topic.prefix&quot;:&quot;quickstart-jdbc-&quot;,&quot;poll.interval.ms&quot;:&quot;1000&quot;,&quot;name&quot;:&quot;quickstart-jdbc-source&quot;},&quot;tasks&quot;:[],&quot;type&quot;:&quot;source&quot;}
</code></pre><h3 id=if-error-message-is-received>If error message is received</h3><p>Make sure MySQL-JDBC JAR file is correctly mounted to container.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker exec connect env | grep -e <span style=color:#e6db74>&#34;^CONNECT_PLUGIN_PATH&#34;</span>
</code></pre></div><pre><code>CONNECT_PLUGIN_PATH=/usr/share/java/kafka,/usr/share/confluent-hub-components,/usr/share/java/kafka-connect-jdbc,/etc/kafka-connect/jars
</code></pre><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker exec connect ls -la /etc/kafka-connect/jars
</code></pre></div><pre><code>total 2312
drwxr-xr-x 2 root root    4096 Mar  2 22:27 .
drwxrwxrwx 1 root root    4096 Mar  2 22:28 ..
-rw-r--r-- 1 root root 2356711 Dec  4 11:44 mysql-connector-java-8.0.19.jar
</code></pre><p>Higher the logging level from docker-compose.yml and run again</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>    <span style=color:#75715e>#CONNECT_LOG4J_ROOT_LOGLEVEL: &#34;DEBUG&#34;</span>
</code></pre></div><h3 id=status-check>Status Check</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Check if new topic is created</span>
docker run <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --net<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>CONNECT_NET<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --rm <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    confluentinc/cp-kafka:5.4.0 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    kafka-topics --describe <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --zookeeper zookeeper:2181 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --topic quickstart-jdbc-test
</code></pre></div><pre><code>Topic: quickstart-jdbc-test	PartitionCount: 1	ReplicationFactor: 1	Configs:
	Topic: quickstart-jdbc-test	Partition: 0	Leader: 1	Replicas: 1	Isr: 1
</code></pre><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker exec schema-registry <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    kafka-avro-console-consumer <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --bootstrap-server broker:29092 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --topic quickstart-jdbc-test <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --from-beginning <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --property print.key<span style=color:#f92672>=</span>true <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --max-messages <span style=color:#ae81ff>10</span> | <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    grep -e <span style=color:#e6db74>&#34;^null&#34;</span>
</code></pre></div><pre><code>null	{&quot;id&quot;:1,&quot;name&quot;:{&quot;string&quot;:&quot;alice&quot;},&quot;email&quot;:{&quot;string&quot;:&quot;alice@abc.com&quot;},&quot;department&quot;:{&quot;string&quot;:&quot;engineering&quot;},&quot;modified&quot;:1583188155000}
null	{&quot;id&quot;:2,&quot;name&quot;:{&quot;string&quot;:&quot;bob&quot;},&quot;email&quot;:{&quot;string&quot;:&quot;bob@abc.com&quot;},&quot;department&quot;:{&quot;string&quot;:&quot;sales&quot;},&quot;modified&quot;:1583188155000}
null	{&quot;id&quot;:3,&quot;name&quot;:{&quot;string&quot;:&quot;bob&quot;},&quot;email&quot;:{&quot;string&quot;:&quot;bob@abc.com&quot;},&quot;department&quot;:{&quot;string&quot;:&quot;sales&quot;},&quot;modified&quot;:1583188155000}
null	{&quot;id&quot;:4,&quot;name&quot;:{&quot;string&quot;:&quot;bob&quot;},&quot;email&quot;:{&quot;string&quot;:&quot;bob@abc.com&quot;},&quot;department&quot;:{&quot;string&quot;:&quot;sales&quot;},&quot;modified&quot;:1583188155000}
null	{&quot;id&quot;:5,&quot;name&quot;:{&quot;string&quot;:&quot;bob&quot;},&quot;email&quot;:{&quot;string&quot;:&quot;bob@abc.com&quot;},&quot;department&quot;:{&quot;string&quot;:&quot;sales&quot;},&quot;modified&quot;:1583188155000}
null	{&quot;id&quot;:6,&quot;name&quot;:{&quot;string&quot;:&quot;bob&quot;},&quot;email&quot;:{&quot;string&quot;:&quot;bob@abc.com&quot;},&quot;department&quot;:{&quot;string&quot;:&quot;sales&quot;},&quot;modified&quot;:1583188155000}
null	{&quot;id&quot;:7,&quot;name&quot;:{&quot;string&quot;:&quot;bob&quot;},&quot;email&quot;:{&quot;string&quot;:&quot;bob@abc.com&quot;},&quot;department&quot;:{&quot;string&quot;:&quot;sales&quot;},&quot;modified&quot;:1583188155000}
null	{&quot;id&quot;:8,&quot;name&quot;:{&quot;string&quot;:&quot;bob&quot;},&quot;email&quot;:{&quot;string&quot;:&quot;bob@abc.com&quot;},&quot;department&quot;:{&quot;string&quot;:&quot;sales&quot;},&quot;modified&quot;:1583188155000}
null	{&quot;id&quot;:9,&quot;name&quot;:{&quot;string&quot;:&quot;bob&quot;},&quot;email&quot;:{&quot;string&quot;:&quot;bob@abc.com&quot;},&quot;department&quot;:{&quot;string&quot;:&quot;sales&quot;},&quot;modified&quot;:1583188155000}
null	{&quot;id&quot;:10,&quot;name&quot;:{&quot;string&quot;:&quot;bob&quot;},&quot;email&quot;:{&quot;string&quot;:&quot;bob@abc.com&quot;},&quot;department&quot;:{&quot;string&quot;:&quot;sales&quot;},&quot;modified&quot;:1583188155000}
Processed a total of 10 messages
</code></pre><h2 id=sink-connector>Sink Connector</h2><h3 id=add-sink-connector>Add sink connector</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Call the API of connect</span>
docker run <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --net<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>CONNECT_NET<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --rm <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    curlimages/curl:7.68.0 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    -s -X POST <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --data <span style=color:#e6db74>&#39;{&#34;name&#34;: &#34;quickstart-avro-file-sink&#34;, &#34;config&#34;: {&#34;connector.class&#34;:&#34;org.apache.kafka.connect.file.FileStreamSinkConnector&#34;, &#34;tasks.max&#34;:&#34;1&#34;, &#34;topics&#34;:&#34;quickstart-jdbc-test&#34;, &#34;file&#34;: &#34;/tmp/quickstart/jdbc-output.txt&#34;}}&#39;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    http://connect:8083/connectors
</code></pre></div><pre><code>{&quot;name&quot;:&quot;quickstart-avro-file-sink&quot;,&quot;config&quot;:{&quot;connector.class&quot;:&quot;org.apache.kafka.connect.file.FileStreamSinkConnector&quot;,&quot;tasks.max&quot;:&quot;1&quot;,&quot;topics&quot;:&quot;quickstart-jdbc-test&quot;,&quot;file&quot;:&quot;/tmp/quickstart/jdbc-output.txt&quot;,&quot;name&quot;:&quot;quickstart-avro-file-sink&quot;},&quot;tasks&quot;:[],&quot;type&quot;:&quot;sink&quot;}
</code></pre><h3 id=status-check-sink>Status check (Sink)</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Check connector status through API</span>
docker run <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --net<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>CONNECT_NET<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --rm <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    curlimages/curl:7.68.0 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    -s -X GET http://connect:8083/connectors/quickstart-avro-file-sink/status
</code></pre></div><pre><code>{&quot;name&quot;:&quot;quickstart-avro-file-sink&quot;,&quot;connector&quot;:{&quot;state&quot;:&quot;RUNNING&quot;,&quot;worker_id&quot;:&quot;connect:8083&quot;},&quot;tasks&quot;:[{&quot;id&quot;:0,&quot;state&quot;:&quot;RUNNING&quot;,&quot;worker_id&quot;:&quot;connect:8083&quot;}],&quot;type&quot;:&quot;sink&quot;}
</code></pre><h2 id=results>Results</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># if using docker-machine</span>
<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> docker-machine &gt;/dev/null 2&gt;&amp;<span style=color:#ae81ff>1</span> <span style=color:#f92672>]</span>
<span style=color:#66d9ef>then</span>
    docker-machine ssh confluent -- cat /tmp/quickstart/file/jdbc-output.txt
<span style=color:#66d9ef>else</span>
    cat /tmp/quickstart/file/jdbc-output.txt
<span style=color:#66d9ef>fi</span>
</code></pre></div><pre><code>Struct{id=1,name=alice,email=alice@abc.com,department=engineering,modified=Mon Mar 02 22:29:15 UTC 2020}
Struct{id=2,name=bob,email=bob@abc.com,department=sales,modified=Mon Mar 02 22:29:15 UTC 2020}
Struct{id=3,name=bob,email=bob@abc.com,department=sales,modified=Mon Mar 02 22:29:15 UTC 2020}
Struct{id=4,name=bob,email=bob@abc.com,department=sales,modified=Mon Mar 02 22:29:15 UTC 2020}
Struct{id=5,name=bob,email=bob@abc.com,department=sales,modified=Mon Mar 02 22:29:15 UTC 2020}
Struct{id=6,name=bob,email=bob@abc.com,department=sales,modified=Mon Mar 02 22:29:15 UTC 2020}
Struct{id=7,name=bob,email=bob@abc.com,department=sales,modified=Mon Mar 02 22:29:15 UTC 2020}
Struct{id=8,name=bob,email=bob@abc.com,department=sales,modified=Mon Mar 02 22:29:15 UTC 2020}
Struct{id=9,name=bob,email=bob@abc.com,department=sales,modified=Mon Mar 02 22:29:15 UTC 2020}
Struct{id=10,name=bob,email=bob@abc.com,department=sales,modified=Mon Mar 02 22:29:15 UTC 2020}
</code></pre><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker-compose stop
</code></pre></div><pre><code>Stopping control-center   ...
Stopping quickstart-mysql ...
Stopping connect          ...
Stopping schema-registry  ...
Stopping broker           ...
Stopping zookeeper        ...
[1Bping zookeeper        ... [32mdone[0m
</code></pre><h2 id=references>References</h2><ul><li><a href=https://docs.confluent.io/5.0.0/installation/docker/docs/installation/connect-avro-jdbc.html>https://docs.confluent.io/5.0.0/installation/docker/docs/installation/connect-avro-jdbc.html</a></li><li><a href=https://www.confluent.io/blog/kafka-connect-deep-dive-jdbc-source-connector/#no-suitable-driver-found>https://www.confluent.io/blog/kafka-connect-deep-dive-jdbc-source-connector/#no-suitable-driver-found</a></li><li><a href=https://rmoff.net/post/kafka-connect-change-log-level-and-write-log-to-file/>https://rmoff.net/post/kafka-connect-change-log-level-and-write-log-to-file/</a></li><li><a href=https://stackoverflow.com/questions/25503412/how-do-i-know-when-my-docker-mysql-container-is-up-and-mysql-is-ready-for-taking>https://stackoverflow.com/questions/25503412/how-do-i-know-when-my-docker-mysql-container-is-up-and-mysql-is-ready-for-taking</a></li></ul></div><div class=post-footer></div></article></main></body></html>